<%@ page language="java" pageEncoding="UTF-8" contentType="text/html; charset=UTF-8"%>
<%@include file="../common/base.jsp" %>
<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>结构管理</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link rel="shortcut icon" href="favicon.ico"> <link href="${path}/static/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="${path}/static/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="${path}/static/css/animate.css" rel="stylesheet">
      <!--LAYER-->
    <link href="${path}/static/js/plugins/layer/skin/layer.css" rel="stylesheet">
    <link href="${path}/static/css/style.css?v=4.1.0" rel="stylesheet">
     <link href="${path}/static/css/zzjg.css" rel="stylesheet">
      <link href="${path}/static/css/zzjg2.css" rel="stylesheet">
    <style>

    </style>




</head>

<body class="gray-bg">
    <div class="wrapper wrapper-content">
        <div class="row animated fadeInRight">
            <div class="col-sm-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>组织结构</h5>
                        <div class="ibox-tools">
                            <a  onclick="opadd()" class="btn btn-primary btn-rounded btn-xs">新增</a>
                              <a href="${path}/orgController/toIndexPage" class="btn btn-primary btn-rounded btn-xs">返回主页</a> <!-- ../index_v1.jsp -->
                        </div>
                    </div>
                    <div>
                       <div class="wrapper wrapper-content animated fadeInRight" style="">

					        <div class="row text-center" style="display:block" id="shangjijiedian">
					    
										        <!-- <div class="col-sm-3" style="margin-left:38%;">
											         
											                <div class="widget red-bg p-lg text-center " ondblclick="xianshi(this)">
											               		<span class="badge badge-danger"><i class="fa fa-close"></i></span>
											                    <div class="m-b-md">
											                        <i class="fa fa-user-md fa-4x"></i>
											                        <h2 class="m-xs">&nbsp;</h2>
											                        <h2 class="font-bold no-margins">
											                               检验科
											                        </h2>
											                       
											                    </div>
											                     <a class="btn btn-danger btn-circle btn-outline btn1" onclick="opedit2()" title="编辑" style="margin-bottom:12px;right:20px"><i class="fa fa-edit"></i></a>
											            <a class="btn btn-danger btn-circle btn2" onclick="deldiv(this)" title="删除"><i class="fa fa-close"></i></a>
											                </div>
											         
										           </div> -->
										        
					          
					        </div>
					         <div class="row text-center" >
					         	<div class="row_1" id="xiajijiedian" >
					         		
											         
											                <!-- <div class="widget navy-bg p-lg text-center w100"  ondblclick="xianshi(this)">
											              
											             
											                    <div class="m-b-md fontlink_gw">
											                      
											                        <h2 class="font-bold no-margins">
											                                临检与血液组
											                        </h2>
											                       
											                    </div>
											           <a class="btn btn-danger btn-circle btn-outline btn1" onclick="opedit()" title="编辑"><i class="fa fa-edit"></i></a>
											            <a class="btn btn-danger btn-circle btn2" onclick="deldiv(this)" title="删除"><i class="fa fa-close"></i></a>
											                </div>
											       
								
											          
											                <div class="widget lazur-bg p-lg text-center w100"  ondblclick="xianshi(this)">
											                
											                    <div class="m-b-md fontlink_gw">
											                        
											                        <h2 class="font-bold no-margins">
											                                  生化组
											                        </h2>
											                       
											                    </div>
											            <a class="btn btn-danger btn-circle btn-outline btn1" onclick="opedit()" title="编辑"><i class="fa fa-edit"></i></a>
											            <a class="btn btn-danger btn-circle btn2" onclick="deldiv(this)" title="删除"><i class="fa fa-close"></i></a>
											                </div>
											           
									
									
									         
									                <div class="widget navy-bg p-lg text-center w100"  ondblclick="xianshi(this)">
									              
									                   <div class="m-b-md fontlink_gw">
									                       
									                        <h2 class="font-bold no-margins">
									                                 免疫组
									                        </h2>
									                       
									                    </div>
									                   <a class="btn btn-danger btn-circle btn-outline btn1" onclick="opedit()" title="编辑"><i class="fa fa-edit"></i></a>
											            <a class="btn btn-danger btn-circle btn2" onclick="deldiv(this)" title="删除"><i class="fa fa-close"></i></a>
									                </div>
									          
								     
											        
											               <div class="widget lazur-bg p-lg text-center w100" ondblclick="xianshi(this)">
											              
											                    <div class="m-b-md fontlink_gw">
											                       
											                        <h2 class="font-bold no-margins">
											                                  微生物组
											                        </h2>
											                       
											                    </div>
											                     <a class="btn btn-danger btn-circle btn-outline btn1" onclick="opedit()" title="编辑"><i class="fa fa-edit"></i></a>
											            		 <a class="btn btn-danger btn-circle btn2" onclick="deldiv(this)" title="删除"><i class="fa fa-close"></i></a>
											                </div>
											         
										       
									
											         
											                <div class="widget navy-bg p-lg text-center w100" ondblclick="xianshi(this)">
											               
											                   <div class="m-b-md fontlink_gw">
											                       
											                        <h2 class="font-bold no-margins">
											                                  分子生物组
											                        </h2>
											                       
											                    </div>
											                    <a class="btn btn-danger btn-circle btn-outline btn1" onclick="opedit()" title="编辑"><i class="fa fa-edit"></i></a>
											            		<a class="btn btn-danger btn-circle btn2" onclick="deldiv(this)" title="删除"><i class="fa fa-close"></i></a>
											                </div> -->
								 </div>       
					         </div>
						</div>
                    </div>
                      
                </div>
            </div>
        </div>
           
    </div>
 

    <!-- 全局js -->
    <script src="${path}/static/js/jquery.min.js"></script>
    <script src="${path}/static/js/bootstrap.min.js"></script>



    <!-- 自定义js -->
    <script src="${path}/static/js/content.js"></script>
 	<!--layer弹出层-->
    <script type="text/javascript" src="${path}/static/js/plugins/layer/layer.min.js"></script>
     <script type="text/javascript" src="${path}/static/js/plugins/layer/extend/layer.ext.js"></script>


   <script type="text/javascript">
  
   	
        /* jQuery(document).ready(function() {
        	$('.fontlink_gw').click(function(){
        	      tiaozhuan();//跳转到组织结构-岗位
        	    });
        });  */
        
        $(function() {
        	$.ajax({
                cache: true,
                type: "POST",
                url:'${path}/orgController/orgList',
                async: false,
                success: function(data) {
                	var html="";
                  	var html2="";
                  	$("#shangjijiedian").empty();
                  	$("#xiajijiedian").empty();	
                  	var data=data.data;
                    for (var i = 0, j = data.length; i < j; i++){
                    	if(data[i].pid==0){
                    			
                    			html +='<div class="col-sm-3" style="margin-left:38%;">'
                          		html +='<div class="widget red-bg p-lg text-center " ondblclick="xianshi(this)">'
                          		html +='<div class="m-b-md">'
                          		html +='<i class="fa fa-user-md fa-4x"></i>'
                          		html +='<h2 class="m-xs">&nbsp;</h2>'
                          		html +='<h2 class="font-bold no-margins">'
                          		html +=data[i].orgname
                          		html +='</h2>'
                          		html +='</div>'
                          		html +='<a class="btn btn-danger btn-circle btn-outline btn1" onclick="opedit2('+data[i].id+')" title="编辑" style="margin-bottom:12px;right:20px"><i class="fa fa-edit"></i></a>'
                          		html +='</div>'                                               
                          		html +='</div>'
                    	}
                    	if(data[i].pid==1){
                    			html2 +='<div class="widget navy-bg p-lg text-center w100" ondblclick="xianshi(this)">'
                    			html2 +='<div class="m-b-md fontlink_gw">'
                    			
                    			html2 +='<h2 class="font-bold no-margins">'
                    			html2 +='<a href="${path}/orgController/listByPid?id='+data[i].id+'">'
                    			html2 +=data[i].orgname
                    			html += '</a>'
                    			html2 +='</h2>'
                    			
                    			html2 +='</div>'
                    			html2 +='<a class="btn btn-danger btn-circle btn-outline btn1" onclick="opedit('+data[i].id+')" title="编辑"><i class="fa fa-edit"></i></a>'
                    			html2 +='<a class="btn btn-danger btn-circle btn2" onclick="deldiv(this,'+data[i].id+')" title="删除"><i class="fa fa-close"></i></a>'
                    			html2 +='</div>'
                    	}
                    }
                    $("#shangjijiedian").append(html);
                    $("#xiajijiedian").append(html2);
                }
            });

        	
        	
        	
                	
            

        });
        
        
	    function tiaozhuan(){//跳转到组织结构-岗位
	    	location.href="zuzzjg_gw.jsp"
	    };
       function deldiv(o,id){ //点击删除按钮 就删除当前的div 
    	  /*  layer.confirm('确认删除此组？', {
               btn: ['确认','取消'] //按钮
               }, function(){//确认就删除
                     var a=$(o).parent();
                         a.remove();
                         layer.msg('已删除', {icon: 1});
           }); 
   
        	 */
        	 layer.prompt({title: '请输入登陆密码确认删除', formType: 1}, function(pass, index){
        		 	$.ajax({
        		 		 cache: true,
        	             type: "POST",
        	             url:'${path}/orgController/passwordConform?pw='+pass+'&id='+id,
        	             async: false,
        	             success: function(data) {
        	            	 if(data.success==true)
        	            	 {
        	            		 layer.close(index);
            	        		 var a=$(o).parent();
            	                 a.remove();
            	        		 layer.msg("删除成功！");
        	            	 }
        	            	 else{
        	            		 layer.msg("密码错误！");
        	            	 }
        	            	 
        	             }
        		 		
        		 	});
        		  	
        		});
       };
       function opedit(id){ //点击按钮 打开编辑页面 
    	   layer.open({
               type: 2 //Page层类型
               ,area: ['30%', '35%']
               ,title: '组织结构-组名编辑'
               ,shade: 0.6 //遮罩透明度
               ,maxmin: false //允许全屏最小化
               ,anim: 5 //0-6的动画形式，-1不开启
               ,content:['${path}/orgController/toEditPage?id='+id]/* zzjg_edit.jsp */
              
             });    

       };
       function opedit2(id){ //点击按钮 打开编辑科室名页面 
    	   layer.open({
               type: 2 //Page层类型
               ,area: ['30%', '35%']
               ,title: '组织结构-科室名编辑'
               ,shade: 0.6 //遮罩透明度
               ,maxmin: false //允许全屏最小化
               ,anim: 5 //0-6的动画形式，-1不开启
               ,content:['zzjg_editksm.jsp']
              
             });    

       };
       function opadd(id){ //点击按钮 打开新增页面 
    	   layer.open({
               type: 2 //Page层类型
               ,area: ['30%', '35%']
               ,title: '组织结构-新增'
               ,shade: 0.6 //遮罩透明度
               ,maxmin: false //允许全屏最小化
               ,anim: 5 //0-6的动画形式，-1不开启
               ,content:['${path}/orgController/toAddPage']  //zzjg_add.jsp
    	   	   ,end: function(){
    	   			
	       		}
              
             });    
   
    	 
       };
       function xianshi(z){
       	a=$(z).find(".btn1");
       	b=$(z).find(".btn2");
       	a.css("display","block");
       	b.css("display","block");
       }
  </script>  

</body>

</html>
